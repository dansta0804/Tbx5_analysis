## Tbx5 gene expression analysis
### Introduction

This part of the work provides the analysis that was performed using the
data from eight ChIP-seq experiments which analyzed gene expression of 
*Tbx5* transcription factor in *Mus musculus* organism.\

The experiments that were used for *Mus musculus* *Tbx5* gene expression
analysis are listed below.\

***Mus musculus:***\

 - [1. EXP058852 ](https://gtrd.biouml.org/#!table/gtrd_current.experiments/Details/ID=EXP058852)(*heart ventricle*)\
 - [2. EXP030898 ](https://gtrd.biouml.org/#!table/gtrd_current.experiments/Details/ID=EXP030898)(*HL-1 (cardiac muscle cells)*)\
 - [3. EXP062056 ](https://gtrd.biouml.org/#!table/gtrd_current.experiments/Details/ID=EXP062056)(*neonatal cardiac fibroblast cells line expressing large T antigen*)\
 - [4. EXP058843 ](https://gtrd.biouml.org/#!table/gtrd_current.experiments/Details/ID=EXP058843)(*mouse embryonic fibroblasts*)\
 - [5. EXP058847 ](https://gtrd.biouml.org/#!table/gtrd_current.experiments/Details/ID=EXP058847)(*mouse embryonic fibroblasts*)\
 - [6. EXP058850 ](https://gtrd.biouml.org/#!table/gtrd_current.experiments/Details/ID=EXP058850)(*mouse embryonic fibroblasts*)\
 - [7. EXP058856 ](https://gtrd.biouml.org/#!table/gtrd_current.experiments/Details/ID=EXP058856)(*mouse embryonic fibroblasts*)\

The analysis provides the following information:\
 **1.** Total peak counts of each performed experiment;\
 **2.** Peak count distribution within different chromosomes.\

```{r Libraries}
library(pacman)
p_load(data.table, rtracklayer, randomcoloR, ggplot2, ggthemes, plyranges, ggpubr,
       BRGenomics, reshape2, plotly, heatmaply, dplyr, gplots, genomation, ggseqlogo,
       BSgenome.Mmusculus.UCSC.mm10, BSgenome, Biostrings)
```

### Total peak counts
The barplot below shows how many *Tbx5* gene peaks were detected while analyzing
four different types of *Mus musculus* cells.

```{r fig, fig.width = 6, fig.height = 7, fig.align = "center"}
# Creating Sample Key table:
samples <- read.csv(file = "sample_key.csv")

# Importing BigBed format files:
pth <- "../BigBed/"
bbfiles <- list.files(path = pth, "*bb")
grl <- GRangesList()
chr_abr <- c(paste0("chr", 1:19), "chrX", "chrY")


for (i in 1:length(bbfiles)) {
    grl[[i]] <- import(paste0(pth, bbfiles[i])) %>% filter(seqnames %in% chr_abr)
    names(grl)[i] <- samples$Graph_names[samples$Filename == bbfiles[i]]
}

peaks <- lapply(grl, length) %>%
            as.data.table()  %>%
            melt() %>%
            as.data.frame()  %>%
            setnames(., c("Experiment", "Peak_count"))

col_fill <- randomColor(1, hue = "red", luminosity = "dark")

bplot1 <- ggplot(peaks, aes(x = peaks$Experiment, y = peaks$Peak_count)) +
                geom_bar(stat = "identity", position = "dodge", width = 0.4,
                         color = "black", fill = col_fill) +
                geom_text(aes(label = peaks$Peak_count),
                          position = position_dodge(width = 0.9), vjust = -0.25) +
                labs(title = "Regionų skaičius mėginiuose",
                     x = "Eksperimentas", y = "Regionų skaičius")

png(file = "Latex/Figures/total_peak_counts.png")
bplot1 + theme(
    panel.background = element_rect(fill = "#eeeef1", colour = "#4c0001"),
    panel.grid.major.y = element_line(colour = "#cab5b5", size = 0.3,
                                      linetype = "dashed"),
    panel.grid.minor.y = element_line(colour = "#cab5b5", size = 0.3,
                                      linetype = "dashed"),
    panel.grid.major.x = element_line(colour = "#cab5b5", size = 0.2,
                                      linetype = "longdash"),
    panel.grid.minor.x = element_line(colour = "#cab5b5", size = 0.2,
                                      linetype = "longdash"),
    axis.text.x = element_text(angle = 45, hjust = 0.5, vjust = 0.5),
    plot.title = element_text(hjust = 0.5, face = "bold"))

dev.off()

# Determining which experiment has a maximum peak count:
max_count <- peaks[which.max(peaks$Peak_count), ]
min_count <- peaks[which.min(peaks$Peak_count), ]
```

According to the barchart, the greatest number of *Tbx5* gene expression peaks was
detected in the cells that were analyzed in
***```r max_count```*** experiment.
The smallest number of *Tbx5* gene peaks was observed in the dataset that was
retrieved from ***```r min_count```*** experiment.

